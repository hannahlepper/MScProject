births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-e) * b
bc <- e * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * r * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * r * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC,
),
Total = P,
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
Init_inf <- 0.2 # Fraction of the pop initially infected
yinit <- c(
U=1-Init_inf,
Ls=0.99*Init_inf,
Lf=0,
I=0.01*Init_inf,
N=0,
C=0,
)
yinit <- c(
U=1-Init_inf,
Ls=0.99*Init_inf,
Lf=0,
I=0.01*Init_inf,
N=0,
C=0
)
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=c(1014,1015),y=c(CDR, (CDR + ((1-CDR)*cov*sens))),method="linear",rule=2)
k <- approxfun(x=c(1014,1015),y=c(k_base,k_int),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-e) * b
bc <- e * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC,
),
Total = P,
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
a = 0.8*0.15+0.2*2*0.15
vs = 0.8*0.0005+0.2*2*0.0005
p = 0.8*0.01+0.2*2*0.01
b = 9
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,cov=0.33,sens=0.9,tau=0.8,k_base=0.6,k_int=0.7, theta=0.01,e=0.37, c=0.2, Ic = 0.4)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=c(1014,1015),y=c(CDR, (CDR + ((1-CDR)*cov*sens))),method="linear",rule=2)
k <- approxfun(x=c(1014,1015),y=c(k_base,k_int),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-e) * b
bc <- e * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC
),
Total = P,
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=c(1014,1015),y=c(CDR, (CDR + ((1-CDR)*cov*sens))),method="linear",rule=2)
k <- approxfun(x=c(1014,1015),y=c(k_base,k_int),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-e) * b
bc <- e * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC
),
Total = P
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=c(1014,1015),y=c(CDR, (CDR + ((1-CDR)*cov*sens))),method="linear",rule=2)
k <- approxfun(x=c(1014,1015),y=c(k_base,k_int),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-r) * b
bc <- r * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC
),
Total = P
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
plot(as.data.frame(sol_base))
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I)
plot(sol_base_df$time, sol_base_df$I)
.02*1014
1/0.02
CDR_int <- function(CDR, cov, sens) {CDR + ((1-CDR)*cov*sens)}
a
vs
rep(c(survey_interval, no_surveys), 3)
survey_interval <- 2   #2 years
no_surveys <- 3
rep(c(survey_interval, no_surveys), 3)
rep(c(survey_interval +1, no_surveys), 3)
cumsum(rep(c(survey_interval +1, no_surveys), 3))
t_sur_interval <- survey_interval * 50
eq_time <- 1000
cumsum(eq_time, rep(t_sur_interval,no_surveys-1))
cumsum(c(eq_time, rep(t_sur_interval,no_surveys-1)))
cumsum(c(eq_time, rep(c(t_sur_interval,1, 1),no_surveys-1)))
survey_times <- cumsum(c(eq_time, 1, 1, rep(c(t_sur_interval,1, 1),no_surveys-1)))
survey_times
survey_times <- function(survey_interval) {
cumsum(c(1000, 1, 1, rep(c(survey_interval*50, 1, 1), 2)))
}
survey_times(2)
survey_times(3)
survey_times(5)
survey_times(2.5)
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=survey_times(survey_interval),y=rep(c(CDR, CDR_survey, CDR),3),method="linear",rule=2)
k <- approxfun(x=c(1014,1015),y=c(k_base,k_int),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-r) * b
bc <- r * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC
),
Total = P
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7, theta=0.01,r=0.37, c=0.2, Ic = 0.4)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I)
plot(sol_base_df$time, sol_base_df$I, type = "l")
PSmodel <- function (t, x,pars) {
with(as.list(c(x,pars)),{
del <- approxfun(x=survey_times(survey_interval),y=rep(c(CDR, CDR_survey, CDR),3),method="linear",rule=2)
k <- approxfun(x=survey_times(survey_interval),y=rep(c(k_base,k_int, k_base),3),method="linear",rule=2)
births <- Mu*(U + Ls + Lf + I + N + C) + Mui*I + Mun*N
P <- U + Ls + Lf + I + N + C
#Betas
bw <- (1-r) * b
bc <- r * b
#FOIs
foi_basic <- bw * U * (I + (c*N))
foi_comm <- bc * U *Ic
foi_exo_react <- bw * a * x * (I + (c*N)) * Ls
foi_exo_react_comm <- bc * a * x * Ic * Ls
foi_reinf <- bw * a * x * (I + (c*N)) * C
foi_reinf_comm <- bc * a * x * Ic * C
# Derivatives
dU <- births - foi_basic - foi_comm - Mu*U
dLs <- ((1-a)*(foi_basic + foi_comm)) - foi_exo_react - foi_exo_react_comm - (vs + Mu)*Ls
dLf <- (a * (foi_basic + foi_comm)) - (vf + Mu)*Lf
dI <- sg*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) + theta*N - (del(t)*k(t)*tau + Mu + Mui + nc)*I
dN <- (1-sg)*(vs*Ls + vf*Lf + foi_exo_react + foi_exo_react_comm
+ foi_reinf + foi_reinf_comm + p*C) - (theta + del(t)*k(t)*tau + Mu + Mun + nc)*N
dC <- (nc + del(t)*k(t)*tau)*(I + N) - foi_reinf - foi_reinf_comm - (p + Mu)*C
# Derived outputs
#    Inc = vs*Ls + vf*Lf + a*x*b*I*(Ls+Lf) + p*C # Incidence
#    Inc_first = vf*Lf
#    Inc_react = vs*Ls
#    Inc_reinf = a*x*b*I*(Ls+Lf)
#    Inc_relap = p*C
#    TB_prev = (I+N)/Total                  # Prevalence
#    Inf_prev = Ls + Lf + I + N + C         # Prevalence of infection
#    TB_Deaths = Mui*I + Mun*N              # Deaths
#    ARI = b*I*100                          # ARI
list(
c(
dU,
dLs,
dLf,
dI,
dN,
dC
),
Total = P
#      Inc = Inc/Total,
#      Inc_first = Inc_first,
#      Inc_react = Inc_react,
#      Inc_reinf = Inc_reinf,
#      Inc_relap = Inc_relap,
#      Prev = TB_prev,
#      Inf_prev = Inf_prev/Total,
#      Mort = TB_Deaths/Total,
#      ARI = ARI
)
})
}
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7,
theta=0.01,r=0.37, c=0.2, Ic = 0.4, survey_interval=5)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I, type = "l")
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7,
theta=0.01,r=0.37, c=0.2, Ic = 0.4, survey_interval=1)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I, type = "l")
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = 1500)
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(500,1500))
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(800,1300))
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200))
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7,
theta=0.01,r=0.37, c=0.2, Ic = 0.1, survey_interval=1)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200))
sol_base_df[c(950:1150),]
CDR <- 0.5
cov <- 0.4
sens <- 0.9
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7,
theta=0.01,r=0.37, c=0.2, Ic = 0.1, survey_interval=1)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200))
sol_base_df[c(110:1150),]
sol_base_df[c(1100:1150),]
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200), ylim = c(0.025,0.045))
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200), ylim = c(0.025,0.04))
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200), ylim = c(0.03,0.035))
plot(sol_base_df$time, sol_base_df$Lf, type = "l", xlim = c(900,1200))
plot(sol_base_df$time, sol_base_df$C, type = "l", xlim = c(900,1200))
p
a
b = 22
pars_base <- c(b=b,Mu=0.02,Mui=0.3,Mun=0.03,nc=0.15,p=p,a=a,vf=0.67,vs=vs,sg=0.5,x=0.35,
CDR=0.33,CDR_survey = CDR_int(CDR, cov, sens),tau=0.8,k_base=0.6,k_int=0.7,
theta=0.01,r=0.37, c=0.2, Ic = 0.1, survey_interval=1)
sol_base <-ode(y=yinit,times=seq(0,2000),func=PSmodel,parms=pars_base)
sol_base_df <- as.data.frame(sol_base)
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200), ylim = c(0.03,0.035))
plot(sol_base_df$time, sol_base_df$C, type = "l", xlim = c(900,1200))
plot(sol_base_df$time, sol_base_df$I, type = "l", xlim = c(900,1200))
library(plyr)
library(deSolve)
library(rootSolve)
library(readr)
setwd("C://Users/hanna/Documents/GitHub/MSc project/")
